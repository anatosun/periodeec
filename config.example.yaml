# Periodeec Configuration Example
# This file demonstrates all available configuration options for the multi-service music sync system

# Core application settings
settings:
  # Beets music library configuration
  beets:
    library: /app/music/library.blb
    directory: /app/music
    config_path: /config/beets.yaml
    autotag:
      strong_rec_thresh: 0.04
      medium_rec_thresh: 0.25
    duplicate_action: skip  # skip, replace, merge

  # Directory structure
  downloads: /app/downloads
  failed: /app/failed
  temp: /app/temp
  playlists: /app/playlists

  # Plex Media Server
  plex:
    baseurl: http://plex-server
    port: 32400
    token: YOUR_PLEX_TOKEN
    section: Music
    create_collections: true
    create_playlists: true
    admin_user: admin@example.com

  # Logging configuration
  logging:
    level: INFO
    file: /app/logs/periodeec.log
    max_size_mb: 100
    backup_count: 5

# Multi-service importer configuration
importers:
  # Spotify configuration
  spotify:
    enabled: true
    client_id: YOUR_SPOTIFY_CLIENT_ID
    client_secret: YOUR_SPOTIFY_CLIENT_SECRET
    anonymous: false
    cache_enabled: true
    cache_ttl_hours: 24
    rate_limit_rpm: 100
    retry_attempts: 3
    request_timeout: 30
    include_collaborative: true
    include_followed: false
    add_source_to_titles: false
    source_tag_format: "(Spotify)"

  # Last.FM configuration
  lastfm:
    enabled: true
    api_key: YOUR_LASTFM_API_KEY
    api_secret: YOUR_LASTFM_API_SECRET
    rate_limit_rpm: 200
    add_source_to_titles: false
    source_tag_format: "(Last.FM)"
    default_limit: 50
    max_retries: 3
    include_top_tracks: true
    include_loved_tracks: true
    top_tracks_periods:
      - overall
      - 12month
      - 6month
      - 3month

  # ListenBrainz configuration
  listenbrainz:
    enabled: true
    user_token: YOUR_LISTENBRAINZ_TOKEN  # Optional for public data
    server_url: https://listenbrainz.org
    rate_limit_rpm: 60
    add_source_to_titles: false
    source_tag_format: "(ListenBrainz)"
    default_limit: 100
    max_retries: 3
    include_top_artists: true
    include_recent_listens: true

# Download source configuration
downloaders:
  # Qobuz high-quality downloads
  qobuz:
    enabled: true
    email: YOUR_QOBUZ_EMAIL
    password: YOUR_QOBUZ_PASSWORD
    quality: 27  # 5=MP3_320, 6=FLAC, 7=24-Bit, 27=Hi-Res
    priority: 10
    max_retries: 3
    timeout: 300
    search_strategy: comprehensive

  # Soulseek P2P via slskd
  slskd:
    enabled: true
    host: localhost
    port: 5030
    api_key: YOUR_SLSKD_API_KEY
    username: your_slsk_username
    password: your_slsk_password
    min_bitrate: 320
    priority: 30
    max_retries: 5
    search_timeout: 60
    download_timeout: 600
    min_file_size_mb: 1
    max_file_size_mb: 100

# User configuration with multi-service support
users:
  # Example user with all services configured
  alice:
    enabled: true

    # Service connections
    service_connections:
      spotify_username: alice_spotify_id
      lastfm_username: alice_lastfm
      listenbrainz_username: alice_listenbrainz

    # Import preferences
    import_preferences:
      primary_service: spotify
      enabled_services:
        - spotify
        - lastfm
        - listenbrainz

      # Service-specific preferences
      spotify:
        include_collaborative: true
        include_followed: false

      lastfm:
        include_top_tracks: true
        include_loved_tracks: true
        top_tracks_periods: [overall, 12month]

      listenbrainz:
        include_top_artists: true
        include_recent_listens: true

    # Plex sync settings
    sync_to_plex_users:
      - alice@example.com

    # Download and sync preferences
    download_missing: true
    create_m3u: true
    schedule_minutes: 1440  # 24 hours
    overwrite: true

  # Example user with only Spotify
  bob:
    enabled: true

    service_connections:
      spotify_username: bob_spotify_id

    import_preferences:
      primary_service: spotify
      enabled_services: [spotify]
      spotify:
        include_collaborative: false
        include_followed: true

    sync_to_plex_users:
      - bob@example.com

    download_missing: false
    create_m3u: true
    schedule_minutes: 2880  # 48 hours

  # Example user with Last.FM focus
  charlie:
    enabled: true

    service_connections:
      lastfm_username: charlie_lastfm
      spotify_username: charlie_spotify_id  # For downloading

    import_preferences:
      primary_service: lastfm
      enabled_services: [lastfm, spotify]
      lastfm:
        include_top_tracks: true
        include_loved_tracks: true
        top_tracks_periods: [overall, 6month]

    sync_to_plex_users:
      - charlie@example.com

    download_missing: true
    create_m3u: false
    schedule_minutes: 720  # 12 hours

# Playlist-specific configuration (optional)
playlists:
  discover_weekly:
    url: spotify:playlist:37i9dQZEVXcBTWulkq8iHy
    title: "Discover Weekly"
    summary: "Spotify's weekly music discovery"
    poster: ""
    schedule_minutes: 10080  # Weekly
    enabled: true

  top_tracks_2024:
    url: lastfm:user:alice_lastfm:toptracks:12month
    title: "My Top Tracks 2024"
    summary: "Last.FM top tracks from the past year"
    schedule_minutes: 1440  # Daily
    enabled: true

# Collection configuration (optional)
collections:
  liked_songs:
    title: "Liked Songs"
    summary: "All liked songs from various services"
    smart_filter: true
    auto_update: true

# Advanced configuration
advanced:
  # Performance tuning
  max_concurrent_downloads: 3
  max_concurrent_imports: 2
  rate_limit_buffer: 0.8
  cache_cleanup_interval: 86400  # 24 hours

  # Retry logic
  download_retry_attempts: 3
  import_retry_attempts: 2
  api_retry_attempts: 3
  retry_backoff_factor: 2.0

  # Quality preferences
  prefer_lossless: true
  min_bitrate: 320
  max_file_size_mb: 100

  # File handling
  sanitize_filenames: true
  preserve_original_structure: false
  create_artist_folders: true
  create_album_folders: true

# Monitoring and health checks
monitoring:
  enabled: true
  health_check_interval: 300  # 5 minutes
  metrics_retention_days: 30
  alert_on_failures: true
  webhook_url: ""  # Optional Discord/Slack webhook

# Development and debugging
debug:
  enabled: false
  log_api_requests: false
  log_file_operations: false
  preserve_temp_files: false
  verbose_downloads: false